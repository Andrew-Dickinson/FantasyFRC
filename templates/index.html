{% extends "/templates/base.html" %}

{% block title %}Fantasy FRC - Main{% endblock %}

{% block content %}
<div class="container">
	
	
	<div class="container_main col-md-12">
        {% if logged_out or league_name == "" %}
            <div class="main">
                <h1>Welcome to Fantasy FRC</h1>
                <div class="alert alert-danger" role="alert">Fantasy FRC is still under development and will likely be ready for the 2016 FRC season</div>
                <p>Fantasy FRC is a <a href="http://en.wikipedia.org/wiki/Fantasy_sport" target="_blank">fantasy sport</a> that uses match data from <a href="http://www.usfirst.org" target="_blank">FIRST Robotics Competion (FRC)</a> to allow users to select and manage fantasy alliances of FRC teams. If this is your first time here, you should check out the <a href="/help/">help page</a>. Otherwise, please remember that this is an early version of this product. Expect bugs and other issues. You can report any bugs you find at our <a href="https://github.com/smarthimandrew/FantasyFRC/issues" target="_blank">Github issues page</a>.  {% if logged_out %} You'll need a google account to do anything useful. You can <a href="https://support.google.com/accounts/answer/27441?source=gsearch" target="_blank">create one</a> or <a href="{{ logged_out }}">log in</a>.{% endif %}</p>
            </div><!--/main-->
        {% endif %}
        {% if not logged_out and league_name=="" %}
            <div>
                <h2>Fantasy FRC is more fun with friends!</h2>
                <p>Join a league on the <a href="/leagueManagement/showLeagues">leagues page</a></p>
            </div>
        {% endif %}
        {% if (draft_state == 0 or draft_state == -10) and league_name != "" %}
            <div>
                <h2>Current League: {{ league_name }}</h2>
                <h3>Members</h3>
                <table class="table" style="max-width: 400px">
                    <tr><td>Name</td></tr>
                    {% for member in league_members %}
                        <tr><td>{{ member }}</td></tr>
                    {% endfor %}
                </table>
                <h2>Getting started</h2>
                <p>GRACE'S DIRECTIONS HERE</p>
            </div>
        {% endif %}
        {% if draft_state != 0 and draft_state != -10 and league_name != "" and not show_league_standings and not logged_out %}
            <div>
                <h2>League: {{ league_name }}</h2>
                {% if draft_state != -1 and draft_state != -10 %}
                    <h3>Draft in progress</h3>
                {% else %}
                    <h3>Draft completed</h3>
                {% endif %}
                {% if users_turn %}
                    <p>It's your turn to pick, go to the <a href="/draft/">draft board</a> to make a selection</p>
                {% else %}
                    {% if draft_state != -1 and draft_state != -10 %}
                        <p>The board shown below is for your convince. It won't refresh. To view a live board with a timer that will automatically refresh, visit the <a href="/draft/">draft page.</a></p>
                    {% endif %}
                {% endif %}
                <table class="table">
                    <th>
                        {% for player in league_members %}
                            <td>{{ player }}</td>
                        {% endfor %}
                    </th>
                    {% for round in draft_board %}
                        <tr>
                            <td>Round {{ loop.index }}</td>
                            {% for pick in round %}
                                <td>{% autoescape false %}
                                    {% if pick != "<i>TBD</i>" and pick != "<i>Forfeited</i>" %}
                                        <a href="/draft/">
                                            {{ pick }}
                                        </a>
                                    {% else %}
                                        {{ pick }}
                                    {% endif %}
                                {% endautoescape %}</td>
                            {% endfor %}
                        </tr>
                    {% endfor %}
                </table>
            </div>
        {% endif %}
        {% if show_league_standings %}
            <h2>Standings for: {{ league_name }}</h2>
            <table class="table">
                <tr><td>Rank</td><td>Name</td><td>W-L-T</td><td>Total Points</td></tr>
                    {% for player in leader_board %}
                        <tr>
                            <td>{{ loop.index }}</td>
                            <td>{{ player.name }}</td>
                            <td>
                                {% for number in player.record %}{{ number }}{% if not loop.last %}-{% endif %}{% endfor %}
                            </td>
                            <td>{{ player.points }}</td>
                        </tr>

                    {% endfor %}
            </table>
        {% endif %}
        {% if draft_state == -1 %}
            <div id="team_list">
                {% set list = team_listss[0][0] %}
                <h3>Alliance Lineup</h3>
                {% if list %}
                    <table class="table">
                    <tr><td>Team</td><td>Swap Action</td><td>Drop</td><td>Points to Date</td></tr>
                    {% for team in list %}
                    <tr>
                        <td>
                            <a href="/allianceManagement/teamDetail/{{team.number}}">{{ team.number }}</a>
                        </td>
                        <td>
                            <a href="/allianceManagement/updateLineup/{{ week_number }}?action=bench&team_number={{ team.number }}">
                            <img src="/static/icons/arrow_refresh.png" alt="Bench Team"/> Bench</a>
                        </td>
                        <td>
                            {% if team.disabled == 'True' %}
                             <a class="category-tooltip" href="" data-toggle="tooltip"
                                    data-original-title="This team is unable to be dropped because of its presence in the top 5">
                                 <img src="/static/icons/lock.png" alt="Team Locked"/></a>
                                <span href="" class="text-disabled"> Drop</span>
                            {% else %}
                                <a href="#"  data-toggle="modal" data-target="#drop_team_modal_{{ team.number }}">
                                <img src="/static/icons/delete.png" alt="Drop Team"/> Drop</a>
                            {% endif %}
                        </td>
                        <td>
                            <a href="/allianceManagement/teamDetail/{{ team.number }}#pointbreakdown">{{ team.total_points }}</a>
                        </td>
                    </tr>
                    {% endfor %}
                    </table>
                {% else %}
                    <p>You have no teams on your active lineup</p>
                {% endif %}
                <p>A full list is available <a href="/allianceManagement/viewAlliance/{{ week_number }}">here</a></p>
            </div>
        {% endif %}
    </div><!--/container_main-->
</div><!--/container-->

    {% if draft_state == -1 %}
         {% set list = team_listss[0][0] %}
            {% for team in list %}
                <!-- drop_team_modals -->
                <div id="drop_team_modal_{{ team.number }}" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
                  <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                          <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                          <h4 class="modal-title">Woah, Careful now&hellip;</h4>
                        </div>
                        <div class="modal-body">
                          <p>Dropping a team is a serious decision. This will remove this team from your roster. You will <b>not</b> earn points in the future from dropped teams.
                              <i>Points scored for this team in past weeks will remain</i>
                          </p>

                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                          <a role="button" href="/allianceManagement/updateLineup/{{ week_number }}?action=drop&team_number={{ team.number }}" class="btn btn-primary btn-danger">Drop Team</a>
                      </div>
                    </div>
                  </div>
                </div>
            {% endfor %}
    {% endif %}
{% endblock %}

{% block inline_javascript %}
<script type="text/javascript">
$(document).ready(function(){
    $(".category-tooltip").tooltip({
        placement : 'left'
    });
});
</script>
{% endblock %}